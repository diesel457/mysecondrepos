module.exports = class FormNumber extends require('../input')
  view: __dirname
  style: __dirname
  name: 'dm-form:number'

  _getExtraFields: -> [
    'min'
    'max'
    'step'
    'lazy'
  ]
  init: ->
    super
    unless @getAttribute('lazy')
      @model.ref '_value', 'value'

  limit: ->
    from = @getAttribute('min')
    to = @getAttribute('max')
    value = @model.get('_value')

    value = undefined if value is '' or value is '-'
    value = parseFloat(value)
    value = undefined if isNaN(value)
    if value?
      if to? and value > to
        value = to
      else if from? and value < from
        value = from
    @model.setDiff '_value', value
    @model.setDiff 'value', value if @getAttribute('lazy')